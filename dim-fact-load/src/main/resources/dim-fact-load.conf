member-transform: {
  peoplesoft: {
    "first_name": "first_name",
    "last_name": "last_name",
    "address": "address1",
    "city": "city",
    "state": "state",
    "zip": "zip_code",
    "zip4": "zip4",
    "source_key": "current_source_key",
    "record_info_key": "record_info_key",
    "member_key": "member_key",
    "match_key": "match_type_key",
    "batch_id": "batch_id"
  },
  tlog_customer: {
    "name_prefix": "name_prefix",
    "first_name": "first_name",
    "last_name": "last_name",
    "name_suffix": "name_suffix",
    "company_name": "company_name",
    "address_line_1": "address1",
    "address_line_2": "address2",
    "city": "city",
    "state": "state",
    "zip_code": "zip_code",
    "non_usa_postal_code": "non_us_postal_code",
    "country": "country_code",
    "ean": "ean",
    "ean_type": "ean_type",
    "loyalty": "loyalty_id",
    "loyalty_type": "loyalty_type",
    "gender": "gender",
    "birth_date": "birth_date",
    "customer_number": "ecommerce_customer_nbr",
    "source_key": "current_source_key",
    "record_info_key": "record_info_key",
    "member_key": "member_key",
    "match_key": "match_type_key",
    "batch_id": "batch_id"
    derived:{
      "gender":"CASE WHEN gender = '' THEN null ELSE gender END"
    }
  },
  ads_600: {
    "first_name": "first_name",
    "last_name": "last_name",
    "street_address": "address1",
    "city": "city",
    "state": "state",
    "zip_code": "zip_code",
    "zip_plus_4": "zip4",
    "do_not_direct_mail": "direct_mail_consent",
    "account_open_date": "direct_mail_consent_date",
    "do_not_statement_insert": "ads_do_not_statement_insert",
    "do_not_sell_name": "ads_do_not_sell_name",
    "spam_indicator": "ads_spam_indicator",
    "email_change_date": "ads_email_change_date",
    "return_mail_indicator": "ads_return_mail_ind",
    "mobile_phone": "phone_nbr",
    "birth_date": "birth_date",
    "marketing_promo_flag": "promotion_consent",
    "source_key": "current_source_key",
    "record_info_key": "record_info_key",
    "member_key": "member_key",
    "match_key": "match_type_key",
    "batch_id": "batch_id"
    derived: {
      "promotion_consent": "CASE WHEN promotion_consent = 1 THEN 'NO'  ELSE 'YES' END"
      "ads_return_mail_ind": "CASE WHEN ads_return_mail_ind != 'Y' THEN NULL ELSE ads_return_mail_ind END"
      "ads_do_not_sell_name":"CASE WHEN ads_do_not_sell_name = '' THEN null ELSE ads_do_not_sell_name END"
      "ads_spam_indicator":"CASE WHEN ads_spam_indicator = '' THEN null ELSE ads_spam_indicator END"
    }
  },
  ads_400: {
    "email_address": "email_address",
    "street_address": "address1",
    "zip_code": "zip_code",
    "zip_plus_4": "zip4",
    "first_name": "first_name",
    "last_name": "last_name",
    "city": "city",
    "state": "state",
    "birth_date": "birth_date",
    "source_key": "current_source_key",
    "record_info_key": "record_info_key",
    "member_key": "member_key",
    "match_key": "match_type_key",
    "batch_id": "batch_id"
  },
  rentallist_venus: {
    "firstname": "first_name",
    "lastname": "last_name",
    "address1": "address1",
    "address2": "address2",
    "city": "city",
    "statecode": "state",
    "zipcode": "zip_code",
    "zip4": "zip4",
    "source_key": "current_source_key",
    "record_info_key": "record_info_key",
    "member_key": "member_key",
    "match_key": "match_type_key",
    "batch_id": "batch_id"
  },
  rentallist_experian: {
    "first_name": "first_name",
    "last_name": "last_name",
    "address1": "address1",
    "address2": "address2",
    "city": "city",
    "state": "state",
    "zip": "zip_code",
    "zip4": "zip4",
    "gender": "gender",
    "source_key": "current_source_key",
    "record_info_key": "record_info_key",
    "member_key": "member_key",
    "match_key": "match_type_key",
    "batch_id": "batch_id"
    derived:{
      "gender":"CASE WHEN gender = '' THEN null ELSE gender END"
    }
  },
  rentallist_jcrew: {
    "first_name": "first_name",
    "last_name": "last_name",
    "address_1": "address1",
    "address_2": "address2",
    "city": "city",
    "state": "state",
    "zip_code": "zip_code",
    "source_key": "current_source_key",
    "record_info_key": "record_info_key",
    "member_key": "member_key",
    "match_key": "match_type_key",
    "batch_id": "batch_id"
  },
  rentallist_anthem: {
    "prefix": "name_prefix"
    "firstname": "first_name",
    "lastname": "last_name",
    "suffix": "name_suffix",
    "address1": "address1",
    "address2": "address2",
    "city": "city",
    "state": "state",
    "zip": "zip_code",
    "zip4": "zip4",
    "source_key": "current_source_key",
    "record_info_key": "record_info_key",
    "member_key": "member_key",
    "match_key": "match_type_key",
    "batch_id": "batch_id",
  },
  ir_mobile_consent: {
    "firstname": "first_name",
    "lastname": "last_name",
    "phone_number": "phone_nbr",
    "address_line_1": "address1",
    "zipcode": "zip_code",
    "city": "city",
    "state": "state",
    "source_key": "current_source_key",
    "record_info_key": "record_info_key",
    "member_key": "member_key",
    "match_key": "match_type_key",
    "batch_id": "batch_id"
  },
  member_email_update: {
    "first_name": "first_name",
    "last_name": "last_name",
    "address_line_1": "address1",
    "zip_code": "zip_code",
    "email_address": "email_address",
    "source_key": "current_source_key",
    "record_info_key": "record_info_key",
    "member_key": "member_key",
    "match_key": "match_type_key",
    "batch_id": "batch_id"
  },
  bp_member: {
    "nameprefix": "name_prefix",
    "firstname": "first_name",
    "lastname": "last_name",
    "namesuffix": "name_suffix",
    "a_addresslineone": "address1",
    "a_addresslinetwo": "address2",
    "ipcode": "ip_code"
    "a_city": "city",
    "a_state": "state",
    "a_zipcode": "zip_code",
    "a_country": "country_code",
    "a_gender": "gender",
    "birthdate": "birth_date",
    "memberstatus": "member_status",
    "membercreatedate": "member_acct_open_date",
    "membercreatedatetime": "member_acct_open_date_time",
    "memberclosedate": "member_acct_close_date",
    "a_enrolldate": "member_acct_enroll_date",
    "a_plccrequestdate": "printed_card_req_date",
    "a_papercertoptin": "printed_cert_opt_in",
    "a_ecertoptin": "e_cert_opt_in",
    "a_ecertoptindate": "e_cert_opt_in_date",
    "a_facebookid": "facebook_id",
    "a_twitterid": "twitter_id",
    "a_enrollmentstorenumber": "lw_enrollment_store_key",
    "a_county": "county",
    "a_addressmailable": "address_mailable",
    "a_membersource": "lw_enrollment_source_key",
    "a_languagepreference": "language_preference",
    "a_securityquestion": "security_question",
    "a_requestloyaltycard": "request_loyalty_card",
    "a_requestpapercertdate": "request_paper_cert_date",
    "a_addresstype": "address_type",
    "a_preapprovalnumber": "preapproval_number",
    "a_preapprovalexpirationdate": "preapproval_expiration_date",
    "a_communicationspref": "communications_pref",
    "a_cdhmemberkey": "cdh_member_key",
    "a_optstatus": "opt_status",
    "a_tokennbrassociationrequest": "token_nbr_association_request",
    "a_confirmageeighteen": "confirm_age_eighteen",
    "a_plccrequestdate": "plcc_request_date",
    "a_plccrequestuserid": "plcc_request_user_id",
    "a_isplccrequest": "is_plcc_request"
    "source_key": "current_source_key",
    "record_info_key": "record_info_key",
    "loyalty_id_number":"loyalty_id",
    "member_key": "member_key",
    "match_key": "match_type_key",
    "batch_id": "batch_id"
    derived: {
      "is_plcc_request": "CASE WHEN is_plcc_request = 1 THEN 'YES' WHEN is_plcc_request = 0 THEN 'NO' ELSE NULL END"
      "member_status": "CASE WHEN member_status = 1 THEN 'ACTIVE' WHEN member_status = 2 THEN 'CANCELED' WHEN member_status = 3 THEN 'CLOSED' WHEN member_status = 4 THEN 'LOCKED' WHEN member_status = 5 THEN 'UNKNOWN' WHEN member_status = 6 THEN 'MERGED' ELSE NULL END"
      "printed_cert_opt_in": "CASE WHEN printed_cert_opt_in = 1 THEN 'YES' WHEN printed_cert_opt_in = 0 THEN 'NO' ELSE NULL END"
      "e_cert_opt_in": "CASE WHEN e_cert_opt_in = 1 THEN 'YES' WHEN e_cert_opt_in = 0 THEN 'NO' ELSE NULL END"
      "gender":"CASE WHEN gender = '' THEN null ELSE gender END"
      "member_source":"CASE WHEN lw_enrollment_source_key is not null THEN lw_enrollment_source_key END"
    }
  },
  chygiene: {
    "first_name": "first_name_scrubbed",
    "last_name": "last_name_scrubbed",
    "primary_address": "address1_scrubbed",
    "secondary_address": "address2_scrubbed",
    "city": "city_scrubbed",
    "zipcode": "zip_code_scrubbed",
    "zip4": "zip4_scrubbed",
    "state": "state_scrubbed",
    "is_prison": "address_is_prison",
    "is_deceased": "deceased",
    "latitude_6_decimals": "latitude",
    "longitude_6_decimals": "longitude",
    "ncoa_last_change_date": "ncoa_last_change_date",
    "dwelling_type": "dwelling_type",
    "valid_strict": "valid_strict",
    "valid_loose": "valid_loose",
    "source_key": "current_source_key",
    "country_code": "country_code",
    "member_key": "member_key",
    "batch_id": "batch_id",
    derived: {
      "address_is_prison": "CASE WHEN address_is_prison = '' THEN null ELSE address_is_prison END"
      "deceased": "CASE WHEN deceased = '' THEN null ELSE deceased END"
    }
  },
  rea_experian: {
    "first_name": "first_name_scrubbed",
    "last_name": "last_name_scrubbed",
    "address_2": "address2_scrubbed",
    "address_1": "address1_scrubbed",
    "city": "city_scrubbed",
    "state": "state_scrubbed",
    "postal_code": "zip_code_scrubbed",
    "zip4_code": "zip4_scrubbed",
    "source_key": "current_source_key",
    "member_key": "member_key",
    "batch_id": "batch_id",
    derived: {
      "first_name_scrubbed": "CASE WHEN first_name_scrubbed = 'NULL' THEN null ELSE first_name_scrubbed END"
      "last_name_scrubbed": "CASE WHEN last_name_scrubbed = 'NULL' THEN null ELSE last_name_scrubbed END"
      "address2_scrubbed": "CASE WHEN address2_scrubbed = 'NULL' THEN null ELSE address2_scrubbed END"
      "address1_scrubbed": "CASE WHEN address1_scrubbed = 'NULL' THEN null ELSE address1_scrubbed END"
      "city_scrubbed": "CASE WHEN city_scrubbed = 'NULL' THEN null ELSE city_scrubbed END"
      "state_scrubbed": "CASE WHEN state_scrubbed = 'NULL' THEN null ELSE state_scrubbed END"
      "zip_code_scrubbed": "CASE WHEN zip_code_scrubbed = 'NULL' THEN null ELSE zip_code_scrubbed END"
      "zip4_scrubbed": "CASE WHEN zip4_scrubbed = 'NULL' THEN null ELSE zip4_scrubbed END"
    }
  },
  rea_acxiom: {
    "first_name": "first_name_scrubbed",
    "last_name": "last_name_scrubbed",
    "address_1": "address1_scrubbed",
    "address_2": "address2_scrubbed",
    "city": "city_scrubbed",
    "state": "state_scrubbed",
    "zip": "zip_code_scrubbed",
    "source_key": "current_source_key",
    "member_key": "member_key",
    "batch_id": "batch_id"
  },
  rpa_acxiom: {
    "first_name": "first_name_scrubbed",
    "last_name": "last_name_scrubbed",
    "address_1": "address1_scrubbed",
    "address_2": "address2_scrubbed",
    "city": "city_scrubbed",
    "state": "state_scrubbed",
    "zip_code": "zip_code_scrubbed",
    "zip4_code": "zip4_scrubbed",
    "source_key": "current_source_key",
    "member_key": "member_key",
    "batch_id": "batch_id"
  },
  rpa_experian: {
    "first_name": "first_name_scrubbed",
    "last_name": "last_name_scrubbed",
    "address_1": "address1_scrubbed",
    "address_2": "address2_scrubbed",
    "city": "city_scrubbed",
    "state": "state_scrubbed",
    "zip_code": "zip_code_scrubbed",
    "zip4_code": "zip4_scrubbed",
    "source_key": "current_source_key",
    "member_key": "member_key",
    "batch_id": "batch_id",
    derived: {
      "first_name_scrubbed": "CASE WHEN first_name_scrubbed = 'NULL' THEN null ELSE first_name_scrubbed END"
      "last_name_scrubbed": "CASE WHEN last_name_scrubbed = 'NULL' THEN null ELSE last_name_scrubbed END"
      "address2_scrubbed": "CASE WHEN address2_scrubbed = 'NULL' THEN null ELSE address2_scrubbed END"
      "address1_scrubbed": "CASE WHEN address1_scrubbed = 'NULL' THEN null ELSE address1_scrubbed END"
      "city_scrubbed": "CASE WHEN city_scrubbed = 'NULL' THEN null ELSE city_scrubbed END"
      "state_scrubbed": "CASE WHEN state_scrubbed = 'NULL' THEN null ELSE state_scrubbed END"
      "zip_code_scrubbed": "CASE WHEN zip_code_scrubbed = 'NULL' THEN null ELSE zip_code_scrubbed END"
      "zip4_scrubbed": "CASE WHEN zip4_scrubbed = 'NULL' THEN null ELSE zip4_scrubbed END"
    }
  }
}

dim-member-consent-transform {
  tlog_customer: {
    "CONSENT_HISTORY_ID": "null",
    "MEMBER_KEY": "member_key",
    "RID": "null",
    "CONSENT_DATE": "dim_consent_date",
    "CONSENT_TYPE": "'DM'",
    "CONSENT_SUBTYPE": "'DIRECTMAIL'",
    "CONSENT_VALUE": "dim_consent_value",
    "IS_LOYALTY": "CASE WHEN loyalty is not null THEN 'YES' WHEN TRIM(loyalty) != '' THEN 'YES' ELSE 'NO' END",
    "SOURCE_KEY": "source_key"
  },
  ads_600: {
    "CONSENT_HISTORY_ID": "null",
    "MEMBER_KEY": "member_key",
    "RID": "null",
    "CONSENT_DATE": "CASE WHEN (CASE WHEN UPPER(TRIM(do_not_direct_mail)) = 'X' THEN 'NO' ELSE COALESCE(dim_consent_value,'') END) = COALESCE(dim_consent_value,'') THEN dim_consent_date ELSE current_date() END",
    "CONSENT_TYPE": "'DM'",
    "CONSENT_SUBTYPE": "'DIRECTMAIL'",
    "CONSENT_VALUE": "CASE WHEN UPPER(TRIM(do_not_direct_mail)) = 'X' THEN 'NO' ELSE dim_consent_value END",
    "IS_LOYALTY": "null",
    "SOURCE_KEY": "8"
  },
  bp_member: {
    "CONSENT_HISTORY_ID": "null",
    "MEMBER_KEY": "member_key",
    "RID": "null",
    "CONSENT_DATE": "CASE WHEN (CASE WHEN a_directmailoptin = 1 AND memberstatus in (1,3,4) THEN 'YES' WHEN a_directmailoptin = 0 AND memberstatus in (1,3,4) THEN 'NO' ELSE COALESCE(dim_consent_value,'') END) = COALESCE(dim_consent_value,'') THEN dim_consent_date ELSE current_date() END",
    "CONSENT_TYPE": "'DM'",
    "CONSENT_SUBTYPE": "'DIRECTMAIL'",
    "CONSENT_VALUE": "CASE WHEN a_directmailoptin = 1 AND memberstatus in (1,3,4) THEN 'YES' WHEN a_directmailoptin = 0 and memberstatus in (1,3,4) THEN 'NO' ELSE dim_consent_value END ",
    "IS_LOYALTY": "'YES'"
    "SOURCE_KEY": "300"
  },

  peoplesoft: {
    "CONSENT_HISTORY_ID": "null",
    "MEMBER_KEY": "member_key",
    "RID": "null",
    "CONSENT_DATE": "dim_consent_date",
    "CONSENT_TYPE": "'DM'",
    "CONSENT_SUBTYPE": "'DIRECTMAIL'",
    "CONSENT_VALUE": "dim_consent_value",
    "IS_LOYALTY": "null",
    "SOURCE_KEY": "144"
  }
  bp_emdmconsent: {
    "CONSENT_HISTORY_ID": "null",
    "MEMBER_KEY": "member_key",
    "RID": "null",
    "CONSENT_DATE": "CASE WHEN (CASE WHEN UPPER(TRIM(optinflag)) = 'Y' THEN 'YES' WHEN UPPER(TRIM(optinflag)) = 'N' THEN 'NO' WHEN UPPER(TRIM(optinflag)) = 'U' THEN 'UNKNOWN' ELSE COALESCE(dim_consent_value,'') END) = COALESCE(dim_consent_value,'') THEN dim_consent_date ELSE COALESCE(to_date(optdate),current_date()) END",
    "CONSENT_TYPE": "'DM'",
    "CONSENT_SUBTYPE": "'DIRECTMAIL'",
    "CONSENT_VALUE": "CASE WHEN UPPER(TRIM(optinflag)) = 'Y' THEN 'YES' WHEN UPPER(TRIM(optinflag)) = 'N' THEN 'NO' WHEN UPPER(TRIM(optinflag)) = 'U' THEN 'UNKNOWN' ELSE dim_consent_value END",
    "IS_LOYALTY": "'YES'",
    "SOURCE_KEY": "1527"
  }
}
member-multi-email-transform: {
  peoplesoft: {
    "first_pos_consent_date_cm": "null",
    "consent_date_retail_cm": "dim_consent_date_retail",
    "consent_value_retail_cm": "dim_consent_value_retail",
    "consent_value_outlet_cm": "dim_consent_value_outlet",
    "consent_date_outlet_cm": "dim_consent_date_outlet",
    "consent_date_next_cm": "dim_consent_date_next",
    "consent_value_next_cm": "dim_consent_value_next",
    "email_consent_cm": "dim_email_consent",
    "email_consent_date_cm": "dim_email_consent_date",
    "valid_email_cm": "dim_valid_email",
    "best_email_flag_cm": "null",
    "best_member_cm": "null",
    "is_loyalty_email_cm": "CASE WHEN is_loyalty_email is null THEN 'NO' ELSE is_loyalty_email END",
    "source_key_cm": "source_key",
    "original_source_key_cm": "source_key",
    "original_store_key_cm": "null",
    "active_inactive_flag_cm": "null",
    "gender_version_cm": "null",
    "frequency_cm": "null",
    "affiliate_id_cm": "null",
    "sub_list_id_cm": "null",
    "consent_history_id_cm": "dim_consent_history_id",
    "rid_cm": "null",
    "mme_id_cm": "dim_mme_id",
    "welcome_email_consent_date_cm": "dim_welcome_email_consent_date"
  },
  ads_400: {
    "first_pos_consent_date_cm": "null",
    "consent_date_retail_cm": "CASE WHEN (CASE WHEN UPPER(TRIM(email_opt_in_indicator)) = 'Y' THEN coalesce(dim_consent_value_retail,'YES') WHEN UPPER(TRIM(email_opt_in_indicator)) = 'N' THEN 'NO' ELSE COALESCE(dim_consent_value_retail,'') END) = COALESCE(dim_consent_value_retail,'') THEN dim_consent_date_retail ELSE current_date() END",
    "consent_value_retail_cm": "CASE WHEN UPPER(TRIM(email_opt_in_indicator)) = 'Y' then coalesce(dim_consent_value_retail,'YES')  WHEN UPPER(TRIM(email_opt_in_indicator)) = 'N' THEN 'NO' ELSE dim_consent_value_retail END",
    "consent_value_outlet_cm": "dim_consent_value_outlet",
    "consent_date_outlet_cm": "dim_consent_date_outlet",
    "consent_date_next_cm": "dim_consent_date_next",
    "consent_value_next_cm": "dim_consent_value_next",
    "email_consent_cm": "CASE WHEN UPPER(TRIM(email_opt_in_indicator)) = 'Y' then coalesce(dim_email_consent,'YES')  WHEN UPPER(TRIM(email_opt_in_indicator)) = 'N' THEN 'NO' ELSE dim_email_consent END",
    "email_consent_date_cm": "CASE WHEN (CASE WHEN UPPER(TRIM(email_opt_in_indicator)) = 'Y' THEN coalesce(dim_email_consent,'YES') WHEN UPPER(TRIM(email_opt_in_indicator)) = 'N' THEN 'NO' ELSE COALESCE(dim_email_consent,'') END) = COALESCE(dim_email_consent,'') THEN dim_email_consent_date ELSE current_date() END",
    "valid_email_cm": "dim_valid_email",
    "best_email_flag_cm": "null",
    "best_member_cm": "null",
    "is_loyalty_email_cm": "CASE WHEN is_loyalty_email is null THEN 'NO' ELSE is_loyalty_email END",
    "source_key_cm": "source_key",
    "original_source_key_cm": "source_key",
    "original_store_key_cm": "store_key",
    "active_inactive_flag_cm": "null",
    "gender_version_cm": "null",
    "frequency_cm": "null",
    "affiliate_id_cm": "null",
    "sub_list_id_cm": "null",
    "consent_history_id_cm": "dim_consent_history_id",
    "rid_cm": "null",
    "mme_id_cm": "dim_mme_id",
    "welcome_email_consent_date_cm": "dim_welcome_email_consent_date"
  },
  ads_600: {
    "first_pos_consent_date_cm": "null",
    "consent_date_retail_cm": "CASE WHEN (CASE WHEN UPPER(TRIM(email_opt_in_indicator)) = 'Y' THEN coalesce(dim_consent_value_retail,'YES') WHEN UPPER(TRIM(email_opt_in_indicator)) = 'N' THEN 'NO' ELSE COALESCE(dim_consent_value_retail,'') END) = COALESCE(dim_consent_value_retail,'') THEN dim_consent_date_retail ELSE current_date() END",
    "consent_value_retail_cm": "CASE WHEN UPPER(TRIM(email_opt_in_indicator)) = 'Y' then coalesce(dim_consent_value_retail,'YES')  WHEN UPPER(TRIM(email_opt_in_indicator)) = 'N' THEN 'NO' ELSE dim_consent_value_retail END",
    "consent_value_outlet_cm": "dim_consent_value_outlet",
    "consent_date_outlet_cm": "dim_consent_date_outlet",
    "consent_date_next_cm": "dim_consent_date_next",
    "consent_value_next_cm": "dim_consent_value_next",
    "email_consent_cm": "CASE WHEN UPPER(TRIM(email_opt_in_indicator)) = 'Y' then coalesce(dim_email_consent,'YES')  WHEN UPPER(TRIM(email_opt_in_indicator)) = 'N' THEN 'NO' ELSE dim_email_consent END",
    "email_consent_date_cm": "CASE WHEN (CASE WHEN UPPER(TRIM(email_opt_in_indicator)) = 'Y' THEN coalesce(dim_email_consent,'YES') WHEN UPPER(TRIM(email_opt_in_indicator)) = 'N' THEN 'NO' ELSE COALESCE(dim_email_consent,'') END) = COALESCE(dim_email_consent,'') THEN dim_email_consent_date ELSE current_date() END",
    "valid_email_cm": "dim_valid_email",
    "best_email_flag_cm": "null",
    "best_member_cm": "null",
    "is_loyalty_email_cm": "CASE WHEN is_loyalty_email is null THEN 'NO' ELSE is_loyalty_email END",
    "source_key_cm": "source_key",
    "original_source_key_cm": "source_key",
    "original_store_key_cm": "store_key",
    "active_inactive_flag_cm": "null",
    "gender_version_cm": "null",
    "frequency_cm": "null",
    "affiliate_id_cm": "null",
    "sub_list_id_cm": "null",
    "consent_history_id_cm": "dim_consent_history_id",
    "rid_cm": "null",
    "mme_id_cm": "dim_mme_id",
    "welcome_email_consent_date_cm": "dim_welcome_email_consent_date"
  },
  tlog_customer: {
    "first_pos_consent_date_cm": "null",
    "consent_date_retail_cm": "CASE WHEN (CASE WHEN lower(trim(email_address_cm)) IS NOT NULL THEN 'YES' ELSE COALESCE(dim_consent_value_retail,'') END) = COALESCE(dim_consent_value_retail,'') THEN dim_consent_date_retail ELSE transaction_date_iso END",
    "consent_value_retail_cm": "CASE WHEN lower(trim(email_address_cm)) IS NOT NULL THEN 'YES' ELSE dim_consent_value_retail END",
    "consent_value_outlet_cm": "dim_consent_value_outlet",
    "consent_date_outlet_cm": "dim_consent_date_outlet",
    "consent_date_next_cm": "dim_consent_date_next",
    "consent_value_next_cm": "dim_consent_value_next",
    "email_consent_cm": "CASE WHEN lower(trim(email_address_cm)) IS NOT NULL THEN 'YES' ELSE dim_email_consent END",
    "email_consent_date_cm": "CASE WHEN (CASE WHEN lower(trim(email_address_cm)) IS NOT NULL THEN 'YES' ELSE COALESCE(dim_email_consent,'') END) = COALESCE(dim_email_consent,'') THEN dim_email_consent_date ELSE transaction_date_iso END",
    "valid_email_cm": "CASE WHEN source_key=6 THEN 'YES' ELSE dim_valid_email END",
    "best_email_flag_cm": "null",
    "best_member_cm": "null",
    "is_loyalty_email_cm": "CASE WHEN is_loyalty_email is null THEN 'NO' ELSE is_loyalty_email END",
    "source_key_cm": "source_key",
    "original_source_key_cm": "source_key",
    "original_store_key_cm": "store_key",
    "active_inactive_flag_cm": "null",
    "gender_version_cm": "null",
    "frequency_cm": "null",
    "affiliate_id_cm": "null",
    "sub_list_id_cm": "null",
    "consent_history_id_cm": "dim_consent_history_id",
    "rid_cm": "null",
    "mme_id_cm": "dim_mme_id",
    "welcome_email_consent_date_cm": "dim_welcome_email_consent_date"
  },
  member_email_update: {
    "first_pos_consent_date_cm": "null",
    "consent_date_retail_cm": "CASE WHEN (CASE WHEN consent_value_retail = '1' THEN 'YES' WHEN consent_value_retail = '0' THEN 'NO' ELSE COALESCE(dim_consent_value_retail,'') END) = COALESCE(dim_consent_value_retail,'')  THEN dim_consent_date_retail  ELSE to_date(last_modified_date) END",
    "consent_value_retail_cm": "CASE WHEN consent_value_retail = 1 THEN 'YES' WHEN consent_value_retail = 0 THEN 'NO' ELSE dim_consent_value_retail END",
    "consent_value_outlet_cm": "CASE WHEN consent_value_outlet = 1 THEN 'YES' WHEN consent_value_outlet = 0 THEN 'NO' ELSE dim_consent_value_outlet END",
    "consent_date_outlet_cm": "CASE WHEN (CASE WHEN consent_value_outlet = 1 THEN 'YES' WHEN consent_value_outlet = 0 THEN 'NO' ELSE COALESCE(dim_consent_value_outlet,'') END) = COALESCE(dim_consent_value_outlet,'') THEN dim_consent_date_outlet ELSE to_date(last_modified_date) END",
    "consent_date_next_cm": "dim_consent_date_next",
    "consent_value_next_cm": "dim_consent_value_next",
    "email_consent_cm": "CASE WHEN consent_value_retail = 1 THEN 'YES' WHEN consent_value_outlet = 1 THEN 'YES' WHEN (consent_value_retail = 0 AND consent_value_outlet = 0) THEN 'NO' ELSE dim_email_consent END",
    "email_consent_date_cm": "CASE WHEN (CASE WHEN consent_value_retail = 'YES' THEN 'YES' WHEN consent_value_outlet = 'YES' THEN 'YES' WHEN consent_value_retail = 1 THEN 'YES' WHEN consent_value_outlet = 1 THEN 'YES' WHEN (consent_value_retail = 0 AND consent_value_outlet = 0) THEN 'NO' ELSE COALESCE(dim_email_consent,'') END) = COALESCE(dim_email_consent,'') THEN dim_email_consent_date ELSE to_date(last_modified_date) END",
    "valid_email_cm": "dim_valid_email",
    "best_email_flag_cm": "null",
    "best_member_cm": "null",
    "is_loyalty_email_cm": "CASE WHEN is_loyalty_email is null THEN 'NO' ELSE is_loyalty_email END",
    "source_key_cm": "source_key",
    "original_source_key_cm": "source_key",
    "original_store_key_cm": "null",
    "active_inactive_flag_cm": "null",
    "gender_version_cm": "CASE WHEN preferred_gender = '1' THEN 'FEMALE' WHEN preferred_gender = '2' THEN 'MALE' WHEN  preferred_gender = '3' THEN 'BOTH' ELSE null END",
    "frequency_cm": "cm_frequency",
    "affiliate_id_cm": "null",
    "sub_list_id_cm": "null",
    "consent_history_id_cm": "dim_consent_history_id",
    "rid_cm": "recipient_id"
    "mme_id_cm": "mme_id",
    "welcome_email_consent_date_cm": "dim_welcome_email_consent_date"
  }
  bp_emdmconsent: {
    "first_pos_consent_date_cm": "null",
    "consent_date_retail_cm": "CASE WHEN (CASE WHEN UPPER(TRIM(optinflag)) = 'Y' THEN 'YES' WHEN UPPER(TRIM(optinflag)) = 'N'  THEN 'NO' ELSE COALESCE(dim_consent_value_retail,'') END) = COALESCE(dim_consent_value_retail,'') THEN dim_consent_date_retail ELSE COALESCE(to_date(optdate),current_date()) END",
    "consent_value_retail_cm": "CASE WHEN UPPER(TRIM(optinflag)) = 'Y' THEN 'YES' WHEN UPPER(TRIM(optinflag)) = 'N' THEN 'NO' ELSE dim_consent_value_retail END",
    "consent_value_outlet_cm": "dim_consent_value_outlet",
    "consent_date_outlet_cm": "dim_consent_date_outlet",
    "consent_date_next_cm": "CASE WHEN (CASE WHEN UPPER(TRIM(optinflag)) = 'Y' AND UPPER(TRIM(is_loyalty_member)) = 'YES'  THEN 'YES' WHEN UPPER(TRIM(optinflag)) = 'N' AND UPPER(TRIM(is_loyalty_member)) = 'YES'  THEN 'NO' ELSE COALESCE(dim_consent_value_next,'') END) = COALESCE(dim_consent_value_next,'') THEN dim_consent_date_next ELSE COALESCE(to_date(optdate),current_date()) END",
    "consent_value_next_cm": "CASE WHEN UPPER(TRIM(optinflag)) = 'Y'  AND UPPER(TRIM(is_loyalty_member)) = 'YES'  THEN 'YES' WHEN UPPER(TRIM(optinflag)) = 'N' AND UPPER(TRIM(is_loyalty_member)) = 'YES'  THEN 'NO' ELSE dim_consent_value_next END",
    "email_consent_cm": "CASE WHEN UPPER(TRIM(optinflag)) = 'Y' THEN 'YES' WHEN UPPER(TRIM(optinflag)) = 'N' THEN 'NO' ELSE dim_email_consent END",
    "email_consent_date_cm": "CASE WHEN (CASE WHEN UPPER(TRIM(optinflag)) = 'Y' THEN 'YES' WHEN UPPER(TRIM(optinflag)) = 'N' THEN 'NO' ELSE COALESCE(dim_email_consent,'') END) = COALESCE(dim_email_consent,'') THEN dim_email_consent_date ELSE COALESCE(to_date(optdate),current_date()) END",
    "valid_email_cm": "dim_valid_email",
    "best_email_flag_cm": "null",
    "best_member_cm": "null",
    "is_loyalty_email_cm": "CASE WHEN is_loyalty_email is null THEN 'NO' ELSE is_loyalty_email END",
    "source_key_cm": "1526",
    "original_source_key_cm": "1526",
    "original_store_key_cm": "null",
    "active_inactive_flag_cm": "null",
    "gender_version_cm": "null",
    "frequency_cm": "null",
    "affiliate_id_cm": "null",
    "sub_list_id_cm": "null",
    "consent_history_id_cm": "dim_consent_history_id",
    "rid_cm": "null",
    "mme_id_cm": "dim_mme_id",
    "welcome_email_consent_date_cm": "dim_welcome_email_consent_date"
    "match_type_key_cm": "0"
  }

  bp_member: {
    "first_pos_consent_date_cm": "null",
    "consent_date_retail_cm": "CASE WHEN (CASE WHEN a_emailoptin = 1 AND memberstatus in (1,3,4) THEN 'YES' WHEN a_emailoptin = 0 AND memberstatus in (1,3,4) THEN 'NO' ELSE COALESCE(dim_consent_value_retail,'') END) = COALESCE(dim_consent_value_retail,'') THEN dim_consent_date_retail ELSE current_date() END",
    "consent_value_retail_cm": "CASE WHEN a_emailoptin = 1 AND memberstatus in (1,3,4) THEN 'YES' WHEN a_emailoptin = 0 AND memberstatus in (1,3,4) THEN 'NO' ELSE dim_consent_value_retail END",
    "consent_value_outlet_cm": "dim_consent_value_outlet",
    "consent_date_outlet_cm": "dim_consent_date_outlet",
    "consent_date_next_cm": "CASE WHEN (CASE WHEN a_emailoptin = 1 AND memberstatus in (1,3,4) THEN 'YES' WHEN  a_emailoptin = 0 AND memberstatus in (1,3,4) THEN 'NO' ELSE COALESCE(dim_consent_value_next,'') END) = COALESCE(dim_consent_value_next,'') THEN dim_consent_date_next ELSE current_date() END"
    "consent_value_next_cm": "CASE WHEN a_emailoptin = 1 AND memberstatus in (1,3,4)  THEN 'YES' WHEN a_emailoptin = 0 AND memberstatus in (1,3,4) THEN 'NO' ELSE dim_consent_value_next END",
    "email_consent_cm": "CASE WHEN a_emailoptin = 1 AND memberstatus in (1,3,4)  THEN 'YES' WHEN a_emailoptin = 0 AND memberstatus in (1,3,4) THEN 'NO' ELSE dim_email_consent END",
    "email_consent_date_cm": "CASE WHEN (CASE WHEN a_emailoptin = 1 AND memberstatus in (1,3,4)  THEN 'YES' WHEN a_emailoptin = 0 AND memberstatus in (1,3,4) THEN 'NO' ELSE COALESCE(dim_email_consent,'') END) = COALESCE(dim_email_consent,'') THEN dim_email_consent_date ELSE current_date() END",
    "valid_email_cm": "dim_valid_email",
    "best_email_flag_cm": "null",
    "best_member_cm": "null",
    "is_loyalty_email_cm": "'YES'",
    "source_key_cm": "300",
    "original_source_key_cm": "300",
    "original_store_key_cm": "store_key",
    "active_inactive_flag_cm": "null",
    "gender_version_cm": "null",
    "frequency_cm": "null",
    "affiliate_id_cm": "null",
    "sub_list_id_cm": "null",
    "consent_history_id_cm": "dim_consent_history_id",
    "rid_cm": "null",
    "mme_id_cm": "dim_mme_id",
    "welcome_email_consent_date_cm": "dim_welcome_email_consent_date"
  }

}

member-multi-phone-transform: {
  tlog_customer: {
    "phone_type_cm": "CASE WHEN NOT(ISNULL(phone_number)) THEN phone_type ELSE 'UNKNOWN' END",
    "phone_consent_cm": "'NO'",
    "phone_consent_date_cm": "null",
    "valid_phone_cm": "'NO'",
    "best_mobile_flag_cm": "'UNKONWN'",
    "best_member_cm": "'UNKONWN'",
    "is_loyalty_flag_cm": "CASE WHEN is_loyalty_flag is null THEN 'NO' ELSE is_loyalty_flag END",
    "source_key_cm": "source_key",
    "original_source_key_cm": "null",
    "match_type_key_cm": "match_key"
  },
  ads_400: {
    "phone_type_cm": "CASE WHEN NOT(ISNULL(phone_number)) THEN phone_type ELSE 'UNKNOWN' END",
    "phone_consent_cm": "'NO'",
    "phone_consent_date_cm": "null",
    "valid_phone_cm": "'NO'",
    "best_mobile_flag_cm": "'UNKONWN'",
    "best_member_cm": "'UNKONWN'",
    "is_loyalty_flag_cm": "CASE WHEN is_loyalty_flag is null THEN 'NO' ELSE is_loyalty_flag END",
    "source_key_cm": "source_key",
    "original_source_key_cm": "null",
    "match_type_key_cm": "match_key"
  },
  ads_600: {
    "phone_type_cm": "CASE WHEN NOT(ISNULL(phone_number)) THEN phone_type ELSE 'UNKNOWN' END",
    "phone_consent_cm": "'NO'",
    "phone_consent_date_cm": "null",
    "valid_phone_cm": "'NO'",
    "best_mobile_flag_cm": "'UNKONWN'",
    "best_member_cm": "'UNKONWN'",
    "is_loyalty_flag_cm": "CASE WHEN is_loyalty_flag is null THEN 'NO' ELSE is_loyalty_flag END",
    "source_key_cm": "source_key",
    "original_source_key_cm": "null",
    "match_type_key_cm": "match_key"
  },
  peoplesoft: {
    "phone_type_cm": "CASE WHEN NOT(ISNULL(phone_number)) THEN phone_type ELSE 'UNKNOWN' END",
    "phone_consent_cm": "'NO'",
    "phone_consent_date_cm": "null",
    "valid_phone_cm": "'NO'",
    "best_mobile_flag_cm": "'UNKONWN'",
    "best_member_cm": "'UNKONWN'",
    "is_loyalty_flag_cm": "CASE WHEN is_loyalty_flag is null THEN 'NO' ELSE is_loyalty_flag END",
    "source_key_cm": "source_key",
    "original_source_key_cm": "null",
    "match_type_key_cm": "match_key"
  },
  ir_mobile_consent: {
    "phone_type_cm": "CASE WHEN NOT(ISNULL(phone_number_cm)) THEN 'MOBILE' ELSE NULL END",
    "phone_consent_cm": "CASE WHEN UPPER(TRIM(consent_status)) = 'I' THEN 'YES' ELSE 'NO' END",
    "phone_consent_date_cm": "CASE WHEN NOT(ISNULL(consent_date)) THEN consent_date ELSE NULL END",
    "valid_phone_cm": "CASE WHEN NOT(ISNULL(phone_number_cm)) THEN 'YES' ELSE 'NO' END",
    "best_mobile_flag_cm": "'UNKONWN'",
    "best_member_cm": "'UNKONWN'",
    "is_loyalty_flag_cm": "CASE WHEN is_loyalty_flag is null THEN 'NO' ELSE is_loyalty_flag END",
    "source_key_cm": "source_key",
    "original_source_key_cm": "null",
    "match_type_key_cm": "match_key"
  },
  bp_member: {
    "phone_type_cm": "CASE WHEN NOT(ISNULL(phone_number)) THEN phone_type ELSE 'UNKNOWN' END",
    "phone_consent_cm": "'NO'",
    "phone_consent_date_cm": "null",
    "valid_phone_cm": "'NO'",
    "best_mobile_flag_cm": "null",
    "best_member_cm": "null",
    "is_loyalty_flag_cm": "'YES'",
    "source_key_cm": "source_key",
    "original_source_key_cm": "null",
    "match_type_key_cm": "match_key"
  }
}
