CustomerEdw: {
  edw_household_feeds: {
    joinColumn: {
      is_express_plcc: ["FLAG"],
      valid_address: ["VALID ADDRESS"],
      record_type: ["RECORD TYPE"]
    }
    finalColumns: ["household_key", "member_count", "first_trxn_date", "is_express_plcc", "add_date", "introduction_date", "last_store_purch_date", "last_web_purch_date", "account_open_date", "zip_code", "scoring_model_key", "scoring_model_segment_key", "valid_address", "record_type", "associated_member_key","ingest_date", "cc_flag", "run_date"]
    tableMainSmith: "edw_dim_household_history"
    tableLookupSmith: "edw_constants"
    regexReplaceColumns: ["zip_code"]
    validation: "select count(distinct(household_key)) as distinct_household_count, SUM(CASE WHEN upper(trim(valid_address)) = 'STRICT' THEN 1 ELSE 0 END) as valid_address_strict, SUM(CASE WHEN upper(trim(valid_address)) = 'LOOSE' THEN 1 ELSE 0 END) as valid_address_loose from smith.edw_household"
    transform: {}
  }

  edw_customer_feeds: {
    joinColumn: {
      valid_strict: ["FLAG"],
      valid_loose: ["FLAG"],
      valid_email: ["FLAG"],
      valid_phone_for_sms: ["FLAG"],
      phone_type: ["PHONE TYPE","UNKNOWN"],
      gender: ["GENDER","UNKNOWN"],
      direct_mail_consent: ["FLAG","UNKNOWN"],
      email_consent: ["FLAG","UNKNOWN"],
      sms_consent: ["FLAG","UNKNOWN"],
      deceased: ["FLAG","UNKNOWN"],
      address_is_prison: ["FLAG","UNKNOWN"],
      is_express_plcc: ["FLAG"],
      ads_do_not_statement_insert: ["ADS_DO_NOT_INSERT"],
      ads_do_not_sell_name: ["ADS_DO_NOT_SELL"],
      ads_spam_indicator: ["ADS_SPAM_INDICATOR"],
      ads_return_mail_ind: ["ADS_RETURN_MAIL_INDICATOR"],
      gender_merch_units: ["GENDER PREF"],
      gender_merch_spend: ["GENDER PREF"],
      customer_age_qualifier: ["AGE QUALIFIER"],
      is_dm_marketable: ["FLAG"],
      is_em_marketable: ["FLAG"],
      is_sms_marketable: ["FLAG"],
      record_type: ["RECORD TYPE"],
      preferred_channel: ["CHANNEL"],
      dominant_shopping_channel: ["CHANNEL"],
      is_loyalty_member: ["FLAG"],
      tier_name: ["LOTALTY TIER"],
      member_status: ["LOYALTY STATUS","UNKNOWN"]
    }

    finalColumns: ["member_key", "household_key", "first_name", "last_name", "address1", "address2", "city", "state", "zip_code", "zip4", "first_name_scrubbed", "last_name_scrubbed", "address1_scrubbed", "address2_scrubbed", "city_scrubbed", "state_scrubbed", "zip_code_scrubbed", "zip4_scrubbed", "zip_full_scrubbed", "non_us_postal_code", "country_code", "country_code_scrubbed", "valid_strict", "valid_loose", "valid_email", "valid_phone_for_sms", "phone_nbr", "phone_type", "email_address", "loyalty_id", "gender", "direct_mail_consent", "email_consent", "sms_consent", "birth_date", "deceased", "address_is_prison", "customer_add_date", "customer_introduction_date", "latitude", "longitude", "closest_store_id", "distance_to_closest_store", "second_closest_store_id", "distance_to_sec_closest_store", "preferred_store_id", "distance_to_preferred_store", "primary_store_id", "secondary_store_id", "last_trxn_date", "last_store_trxn_date", "last_web_trxn_date", "is_express_plcc", "first_trxn_store_id", "first_trxn_date", "brand_first_trxn_date", "ads_do_not_statement_insert", "ads_do_not_sell_name", "ads_spam_indicator", "ads_email_change_date", "ads_return_mail_ind", "gender_merch_units", "gender_merch_spend", "customer_age", "customer_age_qualifier", "is_dm_marketable", "is_em_marketable", "is_sms_marketable", "record_type", "email_consent_date", "sms_consent_date", "direct_mail_consent_date", "preferred_channel", "dominant_shopping_channel", "last_browse_date", "is_loyalty_member", "tier_name", "member_status", "member_acct_open_date", "member_acct_close_date", "member_acct_enroll_date", "customer_next_conv_status", "ncoa_last_change_date", "lw_enrollment_source_key", "lw_enrollment_store_id", "plcc_open_date", "plcc_closed_date", "ingest_date", "cc_flag", "run_date"]

    regexReplaceColumns: ["first_name", "last_name", "address1", "address2", "city", "state", "zip_code", "zip4", "first_name_scrubbed", "last_name_scrubbed", "address1_scrubbed", "address2_scrubbed", "city_scrubbed", "state_scrubbed", "zip_code_scrubbed", "zip4_scrubbed", "zip_full_scrubbed", "non_us_postal_code", "country_code", "country_code_scrubbed", "email_address"]

    tableMainSmith: "edw_dim_member_history"
    tableLookupSmith: "edw_constants"
    validation: "select count(distinct(member_key)) as distinct_member_count, count(loyalty_id) as loyalty_records_count, SUM(CASE WHEN upper(trim(member_status)) = 'ACTIVE' THEN 1 ELSE 0 END) as active_records_count, SUM(CASE WHEN upper(trim(is_express_plcc)) = 'YES' THEN 1 ELSE 0 END) as plcc_records_yes, SUM(CASE WHEN upper(trim(is_express_plcc)) = 'NO' THEN 1 ELSE 0 END) as plcc_records_no from smith.edw_customer "
    transform: {}
  }

  edw_transaction_detail_feeds: {
    joinColumn: {
      is_shipping_cost: ["FLAG"],
      markdown_type: ["MARKDOWN TYPE"],
      gift_card_sales_ind: ["FLAG"],
      post_void_ind: ["INDICATOR"]
    }
    finalColumns: ["transaction_detail_id", "member_key", "trxn_date", "store_id", "exp_order_id", "trxn_id", "tran_number", "register_number", "trxn_seq_nbr", "trxn_time", "sku", "transaction_type_key", "purchase_qty", "shipped_qty", "units", "is_shipping_cost", "original_price", "retail_amount", "total_line_amnt_after_discount", "unit_price_after_discount", "discount_pct", "discount_amount", "discount_type_key", "ring_code_used", "markdown_type", "gift_card_sales_ind", "division_id", "cashier_id", "salesperson", "orig_trxn_nbr", "post_void_ind", "implied_loyalty_id", "captured_loyalty_id", "cogs", "margin","invoicenumber", "ingest_date", "cc_flag", "run_date"]
    tableMainSmith: "edw_transaction_detail"
    tableLookupSmith: "edw_constants"
    regexReplaceColumns: []
    validation: ""
    transform: {}
  }

  edw_transaction_summary_feeds: {
    joinColumn: {
      has_tender: ["FLAG"],
      has_detail: ["FLAG"],
      gift_card_sales_only_ind: ["FLAG"],
      enrollment_trxn_flag: ["FLAG"]
    }
    finalColumns: ["trxn_id","trxn_date","store_id","tran_number","exp_order_id","member_key","register_nbr","w_purchase_qty","m_purchase_qty","gc_purchase_qty","other_purchase_qty","ttl_purchase_qty","w_units","m_units","gc_units","other_units","ttl_purchase_units","w_amount_after_discount","m_amount_after_discount","gc_amount_after_discount","other_amount_after_discount","ttl_amount_after_discount","discount_amount_8888","discount_amount_no_8888","discount_amount","shipping_amount","express_plcc_amount","credit_card_amount","cash_amount","check_amount","gift_card_amount","other_amount","ttl_amount","has_tender","has_detail","gift_card_sales_only_ind","out_w_purchase_qty","out_m_purchase_qty","ttl_out_purchase_qty","out_w_units","out_m_units","ttl_out_units","out_w_amount_after_discount","out_m_amount_after_discount","ttl_out_amount_after_discount","distance_traveled","reward_certs_qty","captured_loyalty_id","implied_loyalty_id","enrollment_trxn_flag","cogs","margin","invoicenumber","ingest_date","cc_flag","run_date"]
    tableMainSmith: "edw_transaction_summary"
    tableLookupSmith: "edw_constants"
    regexReplaceColumns: []
    validation: ""
    transform: {}
  }

  edw_constants_feeds: {
    joinColumn: {}
    finalColumns: ["constant_id", "constant_value", "constant_desc", "constant_type", "run_date"]
    regexReplaceColumns: []
    tableMainSmith: "edw_constants"
    validation: ""
    tableLookupSmith: ""
  }

  edw_customer_dedup_mtx_feeds: {
    joinColumn: {}
    finalColumns: ["old_member_key","new_member_key","customer_deduped_date","cc_flag","run_date"]
    regexReplaceColumns: []
    tableMainSmith: "edw_customer_dedup_mtx"
    validation: ""
    tableLookupSmith: ""
  }

  edw_customer_dedup_txn_mtx_feeds: {
    joinColumn: {}
    finalColumns: ["member_key","trxn_date","store_id","trxn_nbr","exp_order_id","register_nbr","dedupe_run_date","cc_flag","run_date"]
    regexReplaceColumns: []
    tableMainSmith: "edw_customer_dedup_txn_mtx"
    validation: ""
    tableLookupSmith: ""
  }

  edw_lkp_source_feeds:{
    joinColumn: {}
    finalColumns: ["source_key","source_name","source_code","source_description","is_prospect","is_cheetahmail","is_plcc","is_smartreply","is_lw_pilot_conv","is_lw_national_conv","legacy_source_code","legacy_source_description","marketing_brand_code","marketing_brand","run_date"]
    regexReplaceColumns: ["source_description"]
    tableMainSmith: "edw_lkp_source"
    validation: ""
    tableLookupSmith: ""
  }

  edw_lkp_scoring_model_feeds:{
    joinColumn: {}
    finalColumns: ["scoring_model_key","model_id","model_version_id","model_source","marketing_brand_model_code","model_description","model_level_code","model_level","scored_record_count","current_model_ind","effective_date","expiration_date","data_through_date","run_date"]
    regexReplaceColumns: []
    tableMainSmith: "edw_lkp_scoring_model"
    validation: ""
    tableLookupSmith: ""
  }

  edw_lkp_scoring_model_segment_feeds:{
    joinColumn: {}
    finalColumns: ["scoring_model_segment_key","model_id","segment_type","segment_rank","segment_description","segment_grouping","segment_grouping_rank","segment_in_use","run_date"]
    regexReplaceColumns: []
    tableMainSmith: "edw_lkp_scoring_model_segment"
    validation: ""
    tableLookupSmith: ""
  }

  edw_lkp_transaction_type_feeds:{
    joinColumn: {}
    finalColumns: ["transaction_type_key","lbi_trxn_line_type_code","lbi_trxn_line_type_cat_code","price_modified_ind","mobile_pos_ind","associate_trxn_flag","tax_status_flag","transaction_type","loyalty_ind","run_date"]
    regexReplaceColumns: []
    tableMainSmith: "edw_lkp_transaction_type"
    validation: ""
    tableLookupSmith: ""
  }

  edw_lkp_discount_type_feeds:{
    joinColumn: {}
    finalColumns: ["discount_type_key","discount_type_code","discount_deal_code","discount_type_description","discount_deal_description","data_source","run_date"]
    regexReplaceColumns: []
    tableMainSmith: "edw_lkp_discount_type"
    validation: ""
    tableLookupSmith: ""
  }

}

CustomerEdwLookup: {

  edw_lkp_source: {
    targetTableName: "edw_lkp_source"
    sourceTableName: "dim_source"
    filterCondition: "status='current'"
    sourceColumnList: ["source_key", "source_name", "source_code", "source_description", "is_prospect", "is_cheetahmail", "is_plcc", "is_smartreply", "is_lw_pilot_conv", "is_lw_national_conv", "legacy_source_code", "legacy_source_description", "marketing_brand_code", "marketing_brand"]
  }

  edw_lkp_scoring_model: {
    targetTableName: "edw_lkp_scoring_model"
    sourceTableName: "dim_scoring_model"
    filterCondition: "status='current'"
    sourceColumnList: ["scoring_model_key", "model_id", "model_version_id", "model_source", "marketing_brand_model_code", "model_description", "model_level_code", "model_level", "scored_record_count", "current_model_ind", "effective_date", "expiration_date", "data_through_date"]
  }

  edw_lkp_scoring_model_segment: {
    targetTableName: "edw_lkp_scoring_smodel_segment"
    sourceTableName: "dim_scoring_model_segment"
    filterCondition: "status='current'"
    sourceColumnList: ["scoring_model_segment_key", "model_id", "segment_type", "segment_rank", "segment_description", "segment_grouping", "segment_grouping_rank", "segment_in_use"]
  }

  edw_lkp_transaction_type: {
      targetTableName: "edw_lkp_transaction_type"
      sourceTableName: "dim_transaction_type"
      filterCondition: "status='current'"
      sourceColumnList: ["transaction_type_key","lbi_trxn_line_type_code","lbi_trxn_line_type_cat_code","price_modified_ind","mobile_pos_ind","associate_trxn_flag","tax_status_flag","transaction_type","loyalty_ind"]
    }

  edw_lkp_discount_type: {
    targetTableName: "edw_lkp_discount_type"
    sourceTableName: "dim_discount_type"
    filterCondition: "status='current'"
    sourceColumnList: ["discount_type_key","discount_type_code","discount_deal_code","discount_type_description","discount_deal_description","data_source"]
  }

  }

customer-edw-load: {
  edw_dim_member_history: {
    rename: {}
    transform: {}
  }

  edw_dim_household_history: {
    rename: {}
    transform: {}
  }

  edw_transaction_detail: {
    rename: {
      register_nbr: "register_number"
      trxn_nbr: "tran_number"
      trxn_time_key: "trxn_time"
    }
    transform: {}
  }

  edw_transaction_summary: {
    rename: {
      trxn_nbr: "tran_number"
    }
    transform: {}
  }

  edw_customer_dedup_mtx: {
    rename: {
      ingest_date : "customer_deduped_date"
    }
    transform: {}
  }

  edw_customer_dedup_txn_mtx: {
    rename: {
      ingest_date : "dedupe_run_date"
    }
    transform: {}
  }

  edw_lkp_source: {
    rename: {}
    transform: {}
  }

  edw_lkp_scoring_model: {
    rename: {}
    transform: {}
  }

  edw_lkp_scoring_model_segment: {
    rename: {}
    transform: {}
  }

  edw_lkp_transaction_type: {
    rename: {}
    transform: {}
  }

  edw_lkp_discount_type: {
    rename: {}
    transform: {}
  }
}



